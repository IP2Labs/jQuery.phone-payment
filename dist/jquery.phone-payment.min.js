/*! jquery.phone-payment - v1.0.0 - 2017-02-18
* Copyright (c) 2017 mubtxs; Licensed MIT */
"use strict";var $,phoneFromNumber,phoneFromType,phones,defaultFormat,formatBackPhoneNumber,formatPhoneNumber,hasTextSelected,reFormatPhoneNumber,reFormatNumeric,replaceFullWidthChars,restrictPhoneNumber,restrictNumeric,safeVal,setPhoneType,slice=[].slice,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};$=window.jQuery||window.$,$.phonePayment={},$.phonePayment.fn={},$.fn.phonePayment=function(){var a,b;return b=arguments[0],a=2<=arguments.length?slice.call(arguments,1):[],$.phonePayment.fn[b].apply(this,a)},defaultFormat=/(\d{1,3})/g,$.phonePayment.phones=phones=[{type:"mtn",patterns:["77","78","39","077","078","039","25677","25678","25639"],format:defaultFormat,length:[9,10,12]},{type:"airtel",patterns:["70","75","070","075","25670","25675"],format:defaultFormat,length:[9,10,12]},{type:"africell",patterns:["79","079","25679"],format:defaultFormat,length:[9,10,12]},{type:"vodafone",patterns:["72","072","25672"],format:defaultFormat,length:[9,10,12]},{type:"utl",patterns:["71","071","25671"],format:defaultFormat,length:[9,10,12]}],phoneFromNumber=function(a){var b,c,d,e,f,g,h;for(a=(a+"").replace(/\D/g,""),c=0,e=phones.length;c<e;c++)for(b=phones[c],h=b.patterns,d=0,f=h.length;d<f;d++)if(g=h[d],a.substr(0,g.length)===g)return b},phoneFromType=function(a){var b,c,d;for(c=0,d=phones.length;c<d;c++)if(b=phones[c],b.type===a)return b},hasTextSelected=function(a){var b;return null!=a.prop("selectionStart")&&a.prop("selectionStart")!==a.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(b=document.selection)?b.createRange:void 0)||!document.selection.createRange().text)},safeVal=function(a,b){var c,d,e,f,g,h;try{d=b.prop("selectionStart")}catch(a){f=a,d=null}if(g=b.val(),b.val(a),null!==d&&b.is(":focus"))return d===g.length&&(d=a.length),g!==a&&(h=g.slice(d-1,+d+1||9e9),c=a.slice(d-1,+d+1||9e9),e=a[d],/\d/.test(e)&&h===e+" "&&c===" "+e&&(d+=1)),b.prop("selectionStart",d),b.prop("selectionEnd",d)},replaceFullWidthChars=function(a){var b,c,d,e,f,g,h,i;for(null==a&&(a=""),d="０１２３４５６７８９",e="0123456789",i="",b=a.split(""),f=0,h=b.length;f<h;f++)c=b[f],g=d.indexOf(c),g>-1&&(c=e[g]),i+=c;return i},reFormatNumeric=function(a){var b;return b=$(a.currentTarget),setTimeout(function(){var a;return a=b.val(),a=replaceFullWidthChars(a),a=a.replace(/\D/g,""),safeVal(a,b)})},reFormatPhoneNumber=function(a){var b;return b=$(a.currentTarget),setTimeout(function(){var a;return a=b.val(),a=replaceFullWidthChars(a),a=$.phonePayment.formatPhoneNumber(a),safeVal(a,b)})},formatPhoneNumber=function(a){var b,c,d,e,f,g,h;if(d=String.fromCharCode(a.which),/^\d+$/.test(d)&&(b=$(a.currentTarget),h=b.val(),c=phoneFromNumber(h+d),e=(h.replace(/\D/g,"")+d).length,g=16,c&&(g=c.length[c.length.length-1]),!(e>=g||null!=b.prop("selectionStart")&&b.prop("selectionStart")!==h.length)))return f=c&&"amex"===c.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,f.test(h)?(a.preventDefault(),setTimeout(function(){return b.val(h+" "+d)})):f.test(h+d)?(a.preventDefault(),setTimeout(function(){return b.val(h+d+" ")})):void 0},formatBackPhoneNumber=function(a){var b,c;if(b=$(a.currentTarget),c=b.val(),8===a.which&&(null==b.prop("selectionStart")||b.prop("selectionStart")===c.length))return/\d\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.val(c.replace(/\d\s$/,""))})):/\s\d?$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.val(c.replace(/\d$/,""))})):void 0},restrictNumeric=function(a){var b;return!(!a.metaKey&&!a.ctrlKey)||32!==a.which&&(0===a.which||(a.which<33||(b=String.fromCharCode(a.which),!!/[\d\s]/.test(b))))},restrictPhoneNumber=function(a){var b,c,d,e;if(b=$(a.currentTarget),d=String.fromCharCode(a.which),/^\d+$/.test(d)&&!hasTextSelected(b))return e=(b.val()+d).replace(/\D/g,""),c=phoneFromNumber(e),c?e.length<=c.length[c.length.length-1]:e.length<=16},setPhoneType=function(a){var b,c,d,e,f;if(b=$(a.currentTarget),f=b.val(),e=$.phonePayment.phoneType(f)||"unknown",!b.hasClass(e))return c=function(){var a,b,c;for(c=[],a=0,b=phones.length;a<b;a++)d=phones[a],c.push(d.type);return c}(),b.removeClass("unknown"),b.removeClass(c.join(" ")),b.addClass(e),b.toggleClass("identified","unknown"!==e),b.trigger("phonePayment.phoneType",e)},$.phonePayment.fn.formatPhoneNumber=function(){return this.on("keypress",restrictNumeric),this.on("keypress",restrictPhoneNumber),this.on("keypress",formatPhoneNumber),this.on("keydown",formatBackPhoneNumber),this.on("keyup",setPhoneType),this.on("paste",reFormatPhoneNumber),this.on("change",reFormatPhoneNumber),this.on("input",reFormatPhoneNumber),this.on("input",setPhoneType),this},$.phonePayment.fn.restrictNumeric=function(){return this.on("keypress",restrictNumeric),this.on("paste",reFormatNumeric),this.on("change",reFormatNumeric),this.on("input",reFormatNumeric),this},$.phonePayment.validatePhoneNumber=function(a){var b,c;return a=(a+"").replace(/\s+|-/g,""),!!/^\d+$/.test(a)&&(b=phoneFromNumber(a),!!b&&(!(9===a.length&&"7"!==a.charAt(0)||10===a.length&&"07"!==a.substr(0,2)||12===a.length&&"2567"!==a.substr(0,4))&&(c=a.length,indexOf.call(b.length,c)>=0)))},$.phonePayment.phoneType=function(a){var b;return a?(null!=(b=phoneFromNumber(a))?b.type:void 0)||null:null},$.phonePayment.formatPhoneNumber=function(a){var b,c,d,e;return a=a.replace(/\D/g,""),(b=phoneFromNumber(a))?(e=b.length[b.length.length-1],a=a.slice(0,e),b.format.global?null!=(d=a.match(b.format))?d.join(" "):void 0:(c=b.format.exec(a),null!=c?(c.shift(),c=$.grep(c,function(a){return a}),c.join(" ")):void 0)):a};